# Vibe Engineering Prompt: User Food Preference System (Supabase)

## Context
You are building the "Taste & Restriction Layer" of the app. This system allows users to define their dietary preferences and restrictions, which will be crucial for personalizing recipe and meal plan generation.

## Instructions
- Extend the `profiles` table or create a new `user_preferences` table to store user food preferences.
- If extending `profiles`, add `liked_foods` (TEXT[]), `disliked_foods` (TEXT[]), and `avoided_categories` (TEXT[] - e.g., 'dairy', 'gluten', 'vegan').
- If creating a new table:
    - `id` (UUID, primary key)
    - `user_id` (UUID, foreign key to auth.users)
    - `preference_type` (Enum: 'like', 'dislike', 'avoid')
    - `item` (Text - e.g., 'chicken', 'mushrooms', 'gluten')

## Backend Logic (Cursor Instructions)
1. **Preference Storage:** Implement functions to allow users to add, remove, and update their food preferences.
2. **Querying Preferences:** Create a helper function or view that efficiently retrieves all preferences for a given `user_id`.
3. **Integration with Recipe Engine:** The Recipe Generation Engine (Feature 0.10) must query these preferences *before* generating recipes to ensure compliance.
    - For `disliked_foods` and `avoided_categories`, implement a strict exclusion filter.
    - For `liked_foods`, implement a soft preference filter (prioritize, but don't strictly require).

## Vibe Guidelines
- The system should feel intuitive and easy to manage, allowing users to quickly update their tastes.
- Ensure that the preference system is robust enough to handle a wide variety of food items and dietary categories.
- The goal is to make the user feel understood and catered to, reducing the likelihood of irrelevant or unappealing recommendations.
