# Vibe Engineering Prompt: Interpretation & Recommendation (Supabase + Logic)

## Context
You are building the "Brain" of the app. It takes structured biomarker data and turns it into human-readable advice and food lists.

## Instructions
- Create a `biomarker_definitions` table in Supabase to store reference data:
    - `name` (Text, Unique)
    - `optimal_min` (Numeric)
    - `optimal_max` (Numeric)
    - `description` (Text)
- Create an `ingredient_mapping` table:
    - `biomarker_name` (Text)
    - `ingredient_name` (Text)
    - `impact_type` (Enum: 'increase', 'decrease')
    - `rationale` (Text)

## Backend Logic (Cursor Instructions)
1. **Analysis Function:** Create a Supabase Edge Function that:
    - Fetches the user's latest `biomarkers`.
    - Joins with `biomarker_definitions` to find discrepancies.
    - Joins with `ingredient_mapping` to pull relevant foods.
2. **AI Synthesis:** Use an LLM to synthesize this data into a friendly chat message.
    - Input: { "biomarker": "Vitamin D", "value": 25, "optimal": "50-100", "foods": ["Salmon", "Eggs"] }
    - Prompt: "Act as an AI Nutritionist. Explain the discrepancy and how these foods help. Keep it concise and supportive."
3. **Personalization:** Ensure the logic accounts for `sex` and `age` from the `profiles` table when determining "optimal" ranges if they differ from the defaults.

## Vibe Guidelines
- The advice should feel professional yet accessible. Avoid overly medical jargon unless explained.
- Use the "strength rating" to highlight the most important foods first.
