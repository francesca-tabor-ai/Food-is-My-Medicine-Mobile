# Vibe Engineering Prompt: Dashboard & Trends (Supabase + Data Viz)

## Context
You are building the "Progress Layer." It turns rows of data in the `biomarkers` table into beautiful, motivating charts.

## Instructions
- Ensure the `biomarkers` table is optimized for time-series queries (index on `user_id` and `test_date`).
- Create a view or a specific query to fetch historical data for a given biomarker:
    ```sql
    SELECT test_date, value, unit 
    FROM biomarkers 
    WHERE user_id = :user_id AND name = :biomarker_name 
    ORDER BY test_date ASC;
    ```

## Backend Logic (Cursor Instructions)
1. **Trend API:** Create a Supabase Edge Function or a direct query that returns data formatted for a line chart.
2. **Range Integration:** The API should also return the `optimal_min` and `optimal_max` for that biomarker (from the `biomarker_definitions` table) so the frontend can draw "safe zone" bands.
3. **Trend Analysis:** Write a small logic block to calculate the percentage change between the most recent and the previous result.
    - Example: "Your Vitamin D has improved by 15% since your last test."

## Vibe Guidelines
- The charts should be clean and not overcrowded.
- Use colors to indicate status: Green for optimal, Yellow for normal, Red for deficient.
- The focus should be on "Improvement" rather than just the raw numbers.
