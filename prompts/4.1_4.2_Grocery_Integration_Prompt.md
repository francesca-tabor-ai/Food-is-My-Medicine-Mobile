# Vibe Engineering Prompt: Grocery Integration (Supabase + External APIs)

## Context
You are building the "Fulfillment Layer." It bridges the gap between a digital meal plan and physical groceries.

## Instructions
- Create a `shopping_lists` table to aggregate ingredients:
    - `id` (UUID)
    - `user_id` (UUID)
    - `items` (JSONB - { ingredient_name, quantity, unit, is_checked })
    - `retailer_id` (Text)
- Implement a service to map ingredients to SKU strings.

## Backend Logic (Cursor Instructions)
1. **Aggregation Logic:** Create a function that takes a `meal_plan_id`, fetches all associated `recipes`, and sums the `ingredients`.
    - Logic: Group by `ingredient_name` and convert units to a common base (e.g., all to grams) before summing.
2. **Retailer Mapping:** Use an LLM or a lookup table to map generic ingredients (e.g., "Organic Spinach") to likely search terms or specific SKUs for the chosen retailer.
3. **Deep Linking:** Generate a deep link or a payload for a 3rd party API (like Whisk) that populates the user's cart on the retailer's site.
4. **State Management:** Allow the user to "check off" items they already have in their pantry, which removes them from the final cart creation.

## Vibe Guidelines
- The experience should feel like "magic." One tap should populate a full cart.
- Be transparent about pricing and "out of stock" alternatives.
- Prioritize "Organic" or "High Quality" options if the user's profile indicates a preference for premium health.
