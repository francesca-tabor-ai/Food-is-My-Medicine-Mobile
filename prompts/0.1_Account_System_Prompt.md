# Vibe Engineering Prompt: Account System (Supabase Backend)

## Context
You are building the authentication and profile management system for "Food is My Medicine," an AI-driven nutrition app. The backend is Supabase.

## Instructions
- Use Supabase Auth for handling user registration and login (Apple, Google, Email).
- Create a `profiles` table in the `public` schema that automatically links to `auth.users` via a trigger on user creation.
- Ensure the `profiles` table includes the following fields with appropriate validation:
    - `id` (UUID, primary key, references auth.users)
    - `full_name` (Text)
    - `age` (Smallint)
    - `sex` (Enum: 'male', 'female', 'other')
    - `country` (Text/ISO code)
    - `height_cm` (Numeric)
    - `weight_kg` (Numeric)
    - `updated_at` (Timestamp with timezone)

## Backend Logic (Cursor Instructions)
1. **Schema Setup:** Define the SQL for the `profiles` table and set up Row Level Security (RLS) so users can only read/write their own data.
2. **Auth Trigger:** Write a PostgreSQL function and trigger that inserts a new row into `public.profiles` whenever a new user signs up via `auth.users`.
3. **Data Integrity:** Ensure `sex` and `age` are mandatory, as they are used by the biomarker engine later.
4. **API:** Provide clean TypeScript types for the profile object and a Supabase client helper to fetch/update the current user's profile.

## Vibe Guidelines
- Code should be clean, modular, and follow Supabase best practices for RLS.
- Use TypeScript for all frontend-to-backend interactions.
